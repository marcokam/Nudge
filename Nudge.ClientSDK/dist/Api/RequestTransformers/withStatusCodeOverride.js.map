{"version":3,"file":"withStatusCodeOverride.js","sourceRoot":"","sources":["../../../Api/RequestTransformers/withStatusCodeOverride.ts"],"names":[],"mappings":";;;;;;;;;;;AAEA,IAAM,sBAAsB,GAAG,cAA4B,OAAA,UAAC,OAAmB,EAAE,IAAuB;IAEpG,IAAI,CAAC,OAAO,CAAC,kBAAkB,EAAE;QAC7B,OAAO,IAAI,CAAC,OAAO,CAAC,CAAC;KACxB;IACD,IAAM,WAAW,yBACV,OAAO,KACV,OAAO,wBACA,OAAO,CAAC,OAAO,KAClB,6BAA6B,EAAE,GAAG,MAEzC,CAAC;IACF,OAAO,IAAI,CAAC,WAAW,CAAC;SACnB,IAAI,CAAC,UAAA,QAAQ;QACV,IAAM,wBAAwB,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;QACrF,IAAI,CAAC,wBAAwB,EAAE;YAC3B,OAAO,QAAQ,CAAC;SACnB;QACD,IAAM,kBAAkB,GAAG,QAAQ,CAAC,wBAAwB,EAAE,EAAE,CAAC,CAAC;QAClE,IAAI,CAAC,kBAAkB,EAAE;YACrB,OAAO,QAAQ,CAAC;SACnB;QAED,6BACO,QAAQ,KACX,MAAM,EAAE,kBAAkB,IAC5B;IACN,CAAC,CAAC,CAAC;AACX,CAAC,EA5B0D,CA4B1D,CAAC;AACF,eAAe,sBAAsB,CAAC","sourcesContent":["import { ApiRequestMiddleware, ApiRequest, ApiRequestInvoker, ApiResponse } from \"../ApiInterfaces\";\r\n\r\nconst withStatusCodeOverride = (): ApiRequestMiddleware => (request: ApiRequest, next: ApiRequestInvoker): Promise<ApiResponse> => {\r\n\r\n    if (!request.statusCodeOverride) { \r\n        return next(request);       \r\n    }\r\n    const nextRequest = {\r\n        ...request,\r\n        headers: {\r\n            ...request.headers,\r\n            \"X-HTTP-Status-Code-Override\": 200\r\n        }        \r\n    };\r\n    return next(nextRequest)\r\n        .then(response => {\r\n            const originalStatusCodeString = response.headers.get(\"X-Original-Http-Status-Code\");\r\n            if (!originalStatusCodeString) {\r\n                return response;\r\n            }\r\n            const originalStatusCode = parseInt(originalStatusCodeString, 10);\r\n            if (!originalStatusCode) {\r\n                return response;\r\n            }\r\n\r\n            return {\r\n                ...response,\r\n                status: originalStatusCode\r\n            };\r\n        });\r\n};\r\nexport default withStatusCodeOverride;\r\n"]}